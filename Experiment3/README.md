# <center>实验 3</center>

##### <p align="right">PB17000297 罗晏宸</br>2020.8.7</p>

### 实验题目

利用 MPI 解决 N 体问题

N体问题是指找出已知初始位置、速度和质量的多个物体在经典力学情况下的后续运动。在本次实验中，你需要模拟N个物体在二维空间中的运动情况。通过计算每两个物体之间的相互作用力，可以确定下一个时间周期内的物体位置。在本次实验中，初始情况下，$N$ 个小球等间隔分布在一个正方形的二维空间中，小球在运动时没有范围限制。每个小球间会且只会受到其他小球的引力作用。小球可以看成质点。小球移动不会受到其他小球的影响（即不会发生碰撞，挡住等情况）。你需要计算模拟一定时间后小球的分布情况，并通过 MPI 并行化计算过程。

有关参数要求如下：
a. 引力常数数值取 $6.67 \times 10^{-11}$
b. 小球重量都为 $10000 \text{kg}$
c. 小球间的初始间隔为 $1 \text{cm}$ ，例： $N = 36$ 时，初始的正方形区域为 $ 5 \text{cm} \times 5 \text{cm}$
d. 小球初速为 $0$

### 实验环境

#### 操作系统

Windows Subsystem for Linux: Ubuntu 18.04 LTS （内核版本 4.4.0-18362-Microsoft）

#### 编译环境

- g++ 7.5.0

- OpenMP 4.5.0

- MPICH 3.3a2

#### 硬件配置

​	Intel&reg;  Core&trade;  i5-7200U CPU

- 内核数：2
- 线程数：4（超线程）

### 算法设计与分析

### 核心代码

### 实验结果

-  道路情况
每次程序运行都会在`n-body_result`文件夹下输出文件名形如`N-body.data`的数据文件，其中`N`表示小球数量，文件中的数据条目以`Body i : Position ( ,  ), Velocity ( ,  )`的形式记录每个小球在结束模拟之后的位置与速度（在 $x$ 和 $y$ 方向上的分量）。

-  运行时间(s)

| 规模（小球数量）\进程数 | 1           | 2           | 4           |
| :---------- | ----------- | ----------- | ----------- |
| 64      | 0.505444  | 0.348680  | 0.312471 |
| 256      |  10.3277 | 5.88557 | 4.23051 |

- 加速比

| 规模（小球数量）\进程数 | 1           | 2           | 4           |
| :---------- | ----------- | ----------- | ----------- |
| 64        | 1  |1.44959 | 1.61757 |
| 256       | 1 | 1.75475 | 2.44124 |
