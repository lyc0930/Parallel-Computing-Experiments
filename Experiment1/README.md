# <center>实验 1</center>

##### <p align="right">PB17000297 罗晏宸</br>2020.7.7</p>

### 实验题目

利用 MPI，OpenMP 编写简单的程序，测试并行计算系统性能

- 求素数个数
- 求 $\pi$ 值

### 实验环境

#### 操作系统

Windows Subsystem for Linux: Ubuntu 18.04 LTS （内核版本 4.4.0-18362-Microsoft）

#### 编译环境

- g++ 7.5.0

- OpenMP 4.5.0

- MPICH 3.3a2

#### 硬件配置

​	Intel&reg;  Core&trade;  i5-7200U CPU

- 内核数：2
- 线程数：4（超线程）



## <center>求 $\pi$ 值</center>

### <center>MPI 版本</center>

### 算法设计与分析

### 核心代码

### 实验结果

-  运行时间(s)

| 规模\进程数 | 1           | 2           | 4           | 8         |
| :---------- | ----------- | ----------- | ----------- | --------- |
| 1000        | 0.00144696  | 0.00061965  | 0.000505209 | 0.0477698 |
| 10000       | 0.000283241 | 0.000193834 | 0.000147581 | 0.0366936 |
| 100000      | 0.00267577  | 0.00154638  | 0.00075841  | 0.0349624 |
| 500000      | 0.0138242   | 0.00758433  | 0.00435805  | 0.0162234 |
可以看到当进程数超过逻辑 CPU 核数（即线程数 4）时，运行时间显著增加，这是由于每个逻辑 CPU 核心同一时间内最多只能运行一个进程，当并行进程数超过线程数时，CPU 会进行多次进程间的切换调整多个进程的并行运行情况，而进程切换会消耗额外的时间。

- 加速比

| 规模\进程数 | 1    | 2       | 4       | 8          |
| ----------- | ---- | ------- | ------- | ---------- |
| 1000        | 1    | 2.33512 | 2.86408 | 0.0302903  |
| 10000       | 1    | 1.46126 | 1.91922 | 0.00771908 |
| 100000      | 1    | 1.73034 | 3.52813 | 0.0765328  |
| 500000      | 1    | 1.82273 | 3.17211 | 0.852115   |

### <center>OpenMP 版本</center>

### 算法设计与分析

### 核心代码

### 实验结果

-  运行时间(s)

| 规模\进程数 | 1          | 2          | 4           | 8          |
| :---------- | ---------- | ---------- | ----------- | ---------- |
| 1000        | 0.0001627  | 0.0003759  | 0.0004429   | 0.0006718  |
| 10000       | 0.0004279  | 0.0003797  | 0.0004202   | 0.0007339  |
| 100000      | 0.00292969 | 0.00195312 | 0.000976562 | 0.00195312 |
| 500000      | 0.0146484  | 0.00732422 | 0.00390625  | 0.00585938 |


- 加速比

| 规模\进程数 | 1    | 2       | 4       | 8          |
| ----------- | ---- | ------- | ------- | ---------- |
| 1000        | 1    | 2.33512 | 2.86408 | 0.0302903  |
| 10000       | 1    | 1.46126 | 1.91922 | 0.00771908 |
| 100000      | 1    | 1.73034 | 3.52813 | 0.0765328  |
| 500000      | 1    | 1.82273 | 3.17211 | 0.852115   |